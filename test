local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Khanhdzaii/orionlib/refs/heads/main/orionlib"))()

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local VirtualUser = game:GetService("VirtualUser")

-- ========== H·ªÜ TH·ªêNG KEY API ==========
local API_URL = "http://192.168.1.100:5000/verify"  -- Thay IP m√°y m√†y

-- H√†m l·∫•y HWID
local function getHWID()
    local success, hwid = pcall(function()
        if gethwid then
            return gethwid()
        end
        local userId = Player.UserId
        local placeId = game.PlaceId
        local raw = tostring(userId) .. tostring(placeId) .. tostring(tick())
        return HttpService:MD5(raw)
    end)
    return success and hwid or "UNKNOWN_HWID"
end

-- H√†m kick
local function kickPlayer(reason)
    pcall(function()
        game:GetService("TeleportService"):Teleport(game.PlaceId)
        if Player.Character then
            Player.Character:Destroy()
        end
    end)
    OrionLib:MakeNotification({
        Name = "X√ÅC TH·ª∞C TH·∫§T B·∫†I",
        Content = reason or "Key kh√¥ng h·ª£p l·ªá!",
        Time = 5
    })
    wait(2)
end

-- H√†m x√°c th·ª±c key
local function verifyKey()
    local userKey = getgenv().Key
    
    if not userKey or userKey == "" then
        OrionLib:MakeNotification({
            Name = "L·ªñI KEY",
            Content = "Vui l√≤ng nh·∫≠p Key!\ngetgenv().Key = 'keyc·ªßab·∫°n'",
            Time = 5
        })
        return false
    end

    local hwid = getHWID()
    
    local success, result = pcall(function()
        local data = {
            key = userKey,
            hwid = hwid,
            game = "Mixi Jood Piece"
        }
        local response = request({
            Url = API_URL,
            Method = "POST",
            Headers = {["Content-Type"] = "application/json"},
            Body = HttpService:JSONEncode(data)
        })
        if response and response.Success then
            return HttpService:JSONDecode(response.Body)
        end
    end)
    
    if success and result and result.success then
        print("‚úÖ X√°c th·ª±c th√†nh c√¥ng!")
        OrionLib:MakeNotification({
            Name = "TH√ÄNH C√îNG",
            Content = "ƒê√£ x√°c th·ª±c key!",
            Time = 3
        })
        return true
    else
        local reason = (result and result.message) or "Key kh√¥ng h·ª£p l·ªá!"
        kickPlayer(reason)
        return false
    end
end

-- Ch·∫°y x√°c th·ª±c
local verified = verifyKey()
if not verified then
    return
end
-- ========== K·∫æT TH√öC H·ªÜ TH·ªêNG KEY ==========

getgenv().AutoSummon = false
getgenv().AutoRandom = false
getgenv().AutoStore = false
getgenv().NoDelay = false
getgenv().AutoSkillZ = false
getgenv().AutoSkillX = false
getgenv().AutoSkillC = false
getgenv().AutoSkillV = false

-- Bi·∫øn cho Effect Rainbow
getgenv().RainbowEffect = false
local rainbowColors = {
    Color3.fromRGB(255, 0, 0), Color3.fromRGB(255, 127, 0), Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(0, 255, 0), Color3.fromRGB(0, 255, 255), Color3.fromRGB(0, 0, 255),
    Color3.fromRGB(128, 0, 128), Color3.fromRGB(255, 182, 193), Color3.fromRGB(255, 218, 185),
    Color3.fromRGB(255, 255, 224), Color3.fromRGB(200, 255, 200), Color3.fromRGB(200, 230, 255),
}

local DelayTime = 1
local remote = ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent")

-- H√†m g·ª≠i skill
local function useSkill(skillName)
    local args = {
        {
            {
                "Skill",
                skillName,
                CFrame.new(-2222.26904296875, 10.042778968811035, 1603.3192138671875, 0.93825763463974, 6.662140616953138e-09, -0.3459373712539673, -3.8237582544731197e-10, 1, 1.8221140152263615e-08, 0.3459373712539673, -1.6963845439477154e-08, 0.93825763463974)
            },
            "\005"
        }
    }
    remote:FireServer(unpack(args))
end

-- ========== H√ÄM RAINBOW EFFECT ==========
local function makeEffectRainbow(obj)
    if not getgenv().RainbowEffect then return end
    local c = rainbowColors[math.random(#rainbowColors)]
    pcall(function()
        if obj:IsA("ParticleEmitter") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("Fire") then
            obj.Color = c
            obj.SecondaryColor = c
        elseif obj:IsA("Sparkles") then
            obj.SparkleColor = c
        elseif obj:IsA("Trail") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("Beam") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("PointLight") or obj:IsA("SurfaceLight") or obj:IsA("SpotLight") then
            obj.Color = c
        end
    end)
end

-- H√†m b·∫≠t/t·∫Øt Rainbow
local function toggleRainbowEffect(state)
    getgenv().RainbowEffect = state
    if state then
        if _G.RainbowConnections then
            for _, conn in ipairs(_G.RainbowConnections) do
                pcall(function() conn:Disconnect() end)
            end
        end
        _G.RainbowConnections = {}
        local conn1 = Workspace.DescendantAdded:Connect(function(obj)
            makeEffectRainbow(obj)
        end)
        table.insert(_G.RainbowConnections, conn1)
        for _, player in pairs(Players:GetPlayers()) do
            if player.PlayerGui then
                local conn = player.PlayerGui.DescendantAdded:Connect(function(obj)
                    makeEffectRainbow(obj)
                end)
                table.insert(_G.RainbowConnections, conn)
            end
        end
        local conn2 = Players.PlayerAdded:Connect(function(player)
            player:WaitForChild("PlayerGui").DescendantAdded:Connect(function(obj)
                makeEffectRainbow(obj)
            end)
        end)
        table.insert(_G.RainbowConnections, conn2)
        OrionLib:MakeNotification({
            Name = "Rainbow Effect",
            Content = "‚úÖ ƒê√É B·∫¨T - Ch·ªâ effect m·ªõi c√≥ m√†u!",
            Image = "rbxassetid://80452964168019",
            Time = 3
        })
    else
        if _G.RainbowConnections then
            for _, conn in ipairs(_G.RainbowConnections) do
                pcall(function() conn:Disconnect() end)
            end
            _G.RainbowConnections = nil
        end
        OrionLib:MakeNotification({
            Name = "Rainbow Effect",
            Content = "‚≠ï ƒê√É T·∫ÆT",
            Image = "rbxassetid://80452964168019",
            Time = 3
        })
    end
end

-- ========== CODE GIAO DI·ªÜN ==========
local hubColorFile = "HubColor.json"
local textAndBorderColorFile = "TextAndBorderColor.json"
local savedHubColor = nil
local savedTextAndBorderColor = nil

local function saveColor(color, path)
    local colorData = { r = color.R, g = color.G, b = color.B }
    local jsonData = HttpService:JSONEncode(colorData)
    writefile(path, jsonData)
end

local function loadColor(path, defaultColor)
    if isfile(path) then
        local jsonData = readfile(path)
        local colorData = HttpService:JSONDecode(jsonData)
        return Color3.new(colorData.r, colorData.g, colorData.b)
    else
        return defaultColor
    end
end

local function applyHubColor(hubColor)
    if gethui():FindFirstChild("Orion") then
        for _, i in pairs(gethui():GetChildren()) do
            if i.Name == "Orion" then
                for _, v in pairs(i:GetDescendants()) do
                    if v.ClassName == "Frame" and v.BackgroundTransparency < 0.99 then
                        v.BackgroundColor3 = hubColor
                    end
                end
            end
        end
    end
end

local function applyTextAndBorderColor(color)
    if gethui():FindFirstChild("Orion") then
        for _, i in pairs(gethui():GetChildren()) do
            if i.Name == "Orion" then
                for _, v in pairs(i:GetDescendants()) do
                    if v.ClassName == "Frame" then
                        v.BorderColor3 = color
                    end
                    if v:IsA("TextLabel") or v:IsA("TextButton") or v:IsA("TextBox") then
                        v.TextColor3 = color
                    end
                end
            end
        end
    end
end

local function applyHubTransparency(transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame.BackgroundTransparency < 0.99 then
                        frame.BackgroundTransparency = transparency
                    end
                end
            end
        end
    end
end

local BackgroundImages = {
    "79464702411655",
    "78188111267182",
    "87324819549778",
    "106183662263394",
    "101124835052371",
    "104282201865978",
    "109827889408368"
}

local function getRandomImageId()
    return BackgroundImages[math.random(1, #BackgroundImages)]
end

local function applyHubBackground(imageId, transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                local largestFrame = nil
                local maxSize = 0
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame.BackgroundTransparency < 1 then
                        local frameSize = frame.AbsoluteSize.X * frame.AbsoluteSize.Y
                        if frameSize > maxSize then
                            maxSize = frameSize
                            largestFrame = frame
                        end
                    end
                end
                if largestFrame then
                    if largestFrame:FindFirstChild("HubBackground") then
                        largestFrame:FindFirstChild("HubBackground"):Destroy()
                    end
                    local background = Instance.new("ImageLabel")
                    background.Name = "HubBackground"
                    background.Parent = largestFrame
                    background.Size = UDim2.new(1, 0, 1, 0)
                    background.Position = UDim2.new(0, 0, 0, 0)
                    background.Image = "rbxassetid://" .. imageId
                    background.BackgroundTransparency = 1
                    background.ImageTransparency = transparency or 0.7
                    background.ScaleType = Enum.ScaleType.Stretch
                    background.ZIndex = 0
                end
            end
        end
    end
end

local function resetBackground()
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame:FindFirstChild("HubBackground") then
                        frame:FindFirstChild("HubBackground"):Destroy()
                    end
                end
            end
        end
    end
end

local function applyBackgroundTransparency(transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame:FindFirstChild("HubBackground") then
                        frame.HubBackground.ImageTransparency = transparency
                    end
                end
            end
        end
    end
end

savedHubColor = loadColor(hubColorFile, Color3.fromRGB(30, 30, 30))
savedTextAndBorderColor = loadColor(textAndBorderColorFile, Color3.fromRGB(255, 255, 255))

local Window = OrionLib:MakeWindow({
    Name = "Mixi Jood Piece",
    HidePremium = false,
    SaveConfig = false,
    IntroEnabled = false
})

local MainTab = Window:MakeTab({
    Name = "Click It",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

MainTab:AddToggle({
    Name = "Auto Summon Sukuna",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSummon = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoSummon then
            pcall(function()
                ReplicatedStorage.System.Summon:FireServer("Sukuna")
            end)
            task.wait(getgenv().NoDelay and 0 or DelayTime)
        else
            task.wait(0.2)
        end
    end
end)

MainTab:AddToggle({
    Name = "Auto Random Item",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoRandom = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoRandom then
            pcall(function()
                ReplicatedStorage.System.RandomItem:FireServer(5)
            end)
            task.wait(getgenv().NoDelay and 0 or DelayTime)
        else
            task.wait(0.2)
        end
    end
end)

MainTab:AddToggle({
    Name = "Auto C·∫•t",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoStore = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoStore then
            for _,tool in pairs(Player.Backpack:GetChildren()) do
                if tool:IsA("Tool") then
                    pcall(function()
                        ReplicatedStorage.System.Inv.Inventory:InvokeServer("Add", tool.Name)
                    end)
                end
            end
            task.wait(getgenv().NoDelay and 0 or 2)
        else
            task.wait(0.5)
        end
    end
end)

MainTab:AddToggle({
    Name = "Z",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillZ = Value
    end
})

MainTab:AddToggle({
    Name = "X",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillX = Value
    end
})

MainTab:AddToggle({
    Name = "C",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillC = Value
    end
})

MainTab:AddToggle({
    Name = "V",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillV = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoSkillZ or getgenv().AutoSkillX or getgenv().AutoSkillC or getgenv().AutoSkillV then
            if getgenv().AutoSkillZ then
                pcall(function() useSkill("Z") end)
            end
            if getgenv().AutoSkillX then
                pcall(function() useSkill("X") end)
            end
            if getgenv().AutoSkillC then
                pcall(function() useSkill("C") end)
            end
            if getgenv().AutoSkillV then
                pcall(function() useSkill("V") end)
            end
            task.wait(getgenv().NoDelay and 0.1 or 0.5)
        else
            task.wait(0.2)
        end
    end
end)

MainTab:AddButton({
    Name = "Test Skill Z (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("Z") end
})

MainTab:AddButton({
    Name = "Test Skill X (1 l·∫ßn)",  
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("X") end
})

MainTab:AddButton({
    Name = "Test Skill C (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("C") end
})

MainTab:AddButton({
    Name = "Test Skill V (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("V") end
})

MainTab:AddToggle({
    Name = "No Delay",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value) getgenv().NoDelay = Value end
})

local RainbowTab = Window:MakeTab({
    Name = "Effect Rainbow All Game",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

RainbowTab:AddToggle({
    Name = "üåà B·∫≠t/T·∫Øt Rainbow Effect (Ch·ªâ effect m·ªõi)",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        toggleRainbowEffect(Value)
    end
})

RainbowTab:AddLabel("üé® CH·ªà effect m·ªõi xu·∫•t hi·ªán m·ªõi ƒë·ªïi m√†u")
RainbowTab:AddLabel("‚ö° Effect c√≥ s·∫µn s·∫Ω GI·ªÆ NGUY√äN")

local HubTab = Window:MakeTab({
    Name = "Hub Settings",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

local backgroundEnabled = false
local currentTransparency = 0.7
local hubTransparency = 0.3

HubTab:AddToggle({
    Name = "B·∫≠t/T·∫Øt H√¨nh N·ªÅn (Random)",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(isOn)
        backgroundEnabled = isOn
        if isOn then
            applyHubBackground(getRandomImageId(), currentTransparency)
        else
            resetBackground()
        end
    end
})

HubTab:AddDropdown({
    Name = "Ch·ªçn ·∫¢nh N·ªÅn C·ª• Th·ªÉ",
    Options = {
        "79464702411655 - ·∫¢nh 1",
        "78188111267182 - ·∫¢nh 2",
        "87324819549778 - ·∫¢nh 3",
        "106183662263394 - ·∫¢nh 4",
        "101124835052371 - ·∫¢nh 5",
        "104282201865978 - ·∫¢nh 6",
        "109827889408368 - ·∫¢nh 7"
    },
    Default = "79464702411655 - ·∫¢nh 1",
    Callback = function(value)
        local selectedId = value:match("(%d+)")
        if selectedId then
            applyHubBackground(selectedId, currentTransparency)
            backgroundEnabled = true
        end
    end
})

HubTab:AddSlider({
    Name = "ƒê·ªô Trong Su·ªët Hub",
    Min = 0.0,
    Max = 0.98,
    Default = hubTransparency,
    Increment = 0.1,
    Callback = function(value)
        hubTransparency = value
        applyHubTransparency(value)
    end
})

HubTab:AddSlider({
    Name = "ƒê·ªô R√µ H√¨nh N·ªÅn",
    Min = 0.1,
    Max = 0.98,
    Default = currentTransparency,
    Increment = 0.1,
    Callback = function(value)
        currentTransparency = value
        if backgroundEnabled then
            applyBackgroundTransparency(value)
        end
    end
})

HubTab:AddColorpicker({
    Name = "ƒê·ªïi M√†u Hub",
    Default = savedHubColor,
    Callback = function(Value)
        savedHubColor = Value
        saveColor(Value, hubColorFile)
        applyHubColor(savedHubColor)
    end
})

HubTab:AddColorpicker({
    Name = "ƒê·ªïi M√†u Ch·ªØ",
    Default = savedTextAndBorderColor,
    Callback = function(Value)
        savedTextAndBorderColor = Value
        saveColor(Value, textAndBorderColorFile)
        applyTextAndBorderColor(savedTextAndBorderColor)
    end
})

HubTab:AddButton({
    Name = "L√†m M·ªõi Giao Di·ªán",
    Icon = "rbxassetid://80452964168019",
    Callback = function()
        applyHubColor(savedHubColor)
        applyTextAndBorderColor(savedTextAndBorderColor)
        applyHubTransparency(hubTransparency)
        if backgroundEnabled then
            applyHubBackground(getRandomImageId(), currentTransparency)
        end
    end
})

HubTab:AddButton({
    Name = "üóëÔ∏è X√≥a H√¨nh N·ªÅn",
    Icon = "rbxassetid://80452964168019",
    Callback = function()
        resetBackground()
        backgroundEnabled = false
    end
})

task.wait(1)
applyHubColor(savedHubColor)
applyTextAndBorderColor(savedTextAndBorderColor)
applyHubTransparency(hubTransparency)

OrionLib:Init()
