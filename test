local OrionLib = loadstring(game:HttpGet("https://raw.githubusercontent.com/Khanhdzaii/orionlib/refs/heads/main/orionlib"))()

local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Players = game:GetService("Players")
local Player = Players.LocalPlayer
local HttpService = game:GetService("HttpService")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")

getgenv().AutoSummon = false
getgenv().AutoRandom = false
getgenv().AutoStore = false
getgenv().NoDelay = false
getgenv().AutoSkillZ = false
getgenv().AutoSkillX = false
getgenv().AutoSkillC = false
getgenv().AutoSkillV = false

-- Bi·∫øn cho Effect Rainbow
getgenv().RainbowEffect = false
local rainbowColors = {
    Color3.fromRGB(255, 0, 0), Color3.fromRGB(255, 127, 0), Color3.fromRGB(255, 255, 0),
    Color3.fromRGB(0, 255, 0), Color3.fromRGB(0, 255, 255), Color3.fromRGB(0, 0, 255),
    Color3.fromRGB(128, 0, 128), Color3.fromRGB(255, 182, 193), Color3.fromRGB(255, 218, 185),
    Color3.fromRGB(255, 255, 224), Color3.fromRGB(200, 255, 200), Color3.fromRGB(200, 230, 255),
}

local DelayTime = 1
local remote = ReplicatedStorage:WaitForChild("BridgeNet2"):WaitForChild("dataRemoteEvent")

-- H√†m g·ª≠i skill
local function useSkill(skillName)
    local args = {
        {
            {
                "Skill",
                skillName,
                CFrame.new(-2222.26904296875, 10.042778968811035, 1603.3192138671875, 0.93825763463974, 6.662140616953138e-09, -0.3459373712539673, -3.8237582544731197e-10, 1, 1.8221140152263615e-08, 0.3459373712539673, -1.6963845439477154e-08, 0.93825763463974)
            },
            "\005"
        }
    }
    
    remote:FireServer(unpack(args))
end

-- ========== H√ÄM RAINBOW EFFECT (CH·ªà EFFECT M·ªöI) ==========
local function makeEffectRainbow(obj)
    if not getgenv().RainbowEffect then return end
    
    local c = rainbowColors[math.random(#rainbowColors)]
    pcall(function()
        if obj:IsA("ParticleEmitter") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("Fire") then
            obj.Color = c
            obj.SecondaryColor = c
        elseif obj:IsA("Sparkles") then
            obj.SparkleColor = c
        elseif obj:IsA("Trail") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("Beam") then
            obj.Color = ColorSequence.new(c)
        elseif obj:IsA("PointLight") or obj:IsA("SurfaceLight") or obj:IsA("SpotLight") then
            obj.Color = c
        end
    end)
end

-- H√†m b·∫≠t/t·∫Øt (CH·ªà b·∫Øt effect m·ªõi, KH√îNG qu√©t effect c≈©)
local function toggleRainbowEffect(state)
    getgenv().RainbowEffect = state
    
    if state then
        -- H·ªßy connections c≈© n·∫øu c√≥
        if _G.RainbowConnections then
            for _, conn in ipairs(_G.RainbowConnections) do
                pcall(function() conn:Disconnect() end)
            end
        end
        
        _G.RainbowConnections = {}
        
        -- CH·ªà b·∫Øt effect m·ªõi xu·∫•t hi·ªán trong Workspace
        local conn1 = Workspace.DescendantAdded:Connect(function(obj)
            makeEffectRainbow(obj)
        end)
        table.insert(_G.RainbowConnections, conn1)
        
        -- B·∫Øt effect m·ªõi trong PlayerGui c·ªßa t·∫•t c·∫£ players
        for _, player in pairs(Players:GetPlayers()) do
            if player.PlayerGui then
                local conn = player.PlayerGui.DescendantAdded:Connect(function(obj)
                    makeEffectRainbow(obj)
                end)
                table.insert(_G.RainbowConnections, conn)
            end
        end
        
        -- B·∫Øt khi c√≥ player m·ªõi join
        local conn2 = Players.PlayerAdded:Connect(function(player)
            player:WaitForChild("PlayerGui").DescendantAdded:Connect(function(obj)
                makeEffectRainbow(obj)
            end)
        end)
        table.insert(_G.RainbowConnections, conn2)
        
        OrionLib:MakeNotification({
            Name = "Rainbow Effect",
            Content = "‚úÖ ƒê√É B·∫¨T - Ch·ªâ effect m·ªõi c√≥ m√†u!",
            Image = "rbxassetid://80452964168019",
            Time = 3
        })
        
    else
        -- H·ªßy t·∫•t c·∫£ connections khi t·∫Øt
        if _G.RainbowConnections then
            for _, conn in ipairs(_G.RainbowConnections) do
                pcall(function() conn:Disconnect() end)
            end
            _G.RainbowConnections = nil
        end
        
        OrionLib:MakeNotification({
            Name = "Rainbow Effect",
            Content = "‚≠ï ƒê√É T·∫ÆT",
            Image = "rbxassetid://80452964168019",
            Time = 3
        })
    end
end

-- ========== CODE GIAO DI·ªÜN (H√åNH N·ªÄN, M√ÄU S·∫ÆC) ==========
local hubColorFile = "HubColor.json"
local textAndBorderColorFile = "TextAndBorderColor.json"
local savedHubColor = nil
local savedTextAndBorderColor = nil

-- H√†m l∆∞u m√†u v√†o file
local function saveColor(color, path)
    local colorData = { r = color.R, g = color.G, b = color.B }
    local jsonData = HttpService:JSONEncode(colorData)
    writefile(path, jsonData)
end

-- H√†m t·∫£i m√†u t·ª´ file
local function loadColor(path, defaultColor)
    if isfile(path) then
        local jsonData = readfile(path)
        local colorData = HttpService:JSONDecode(jsonData)
        return Color3.new(colorData.r, colorData.g, colorData.b)
    else
        return defaultColor
    end
end

-- H√†m √°p d·ª•ng m√†u n·ªÅn cho Hub
local function applyHubColor(hubColor)
    if gethui():FindFirstChild("Orion") then
        for _, i in pairs(gethui():GetChildren()) do
            if i.Name == "Orion" then
                for _, v in pairs(i:GetDescendants()) do
                    if v.ClassName == "Frame" and v.BackgroundTransparency < 0.99 then
                        v.BackgroundColor3 = hubColor
                    end
                end
            end
        end
    end
end

-- H√†m √°p d·ª•ng m√†u vi·ªÅn v√† ch·ªØ
local function applyTextAndBorderColor(color)
    if gethui():FindFirstChild("Orion") then
        for _, i in pairs(gethui():GetChildren()) do
            if i.Name == "Orion" then
                for _, v in pairs(i:GetDescendants()) do
                    if v.ClassName == "Frame" then
                        v.BorderColor3 = color
                    end
                    if v:IsA("TextLabel") or v:IsA("TextButton") or v:IsA("TextBox") then
                        v.TextColor3 = color
                    end
                end
            end
        end
    end
end

-- H√†m √°p d·ª•ng ƒë·ªô trong su·ªët c·ªßa Hub
local function applyHubTransparency(transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame.BackgroundTransparency < 0.99 then
                        frame.BackgroundTransparency = transparency
                    end
                end
            end
        end
    end
end

-- ========== ID H√åNH N·ªÄN ==========
local BackgroundImages = {
    "79464702411655",
    "78188111267182",
    "87324819549778",
    "106183662263394",
    "101124835052371",
    "104282201865978",
    "109827889408368"
}

-- H√†m ch·ªçn ng·∫´u nhi√™n ID h√¨nh n·ªÅn
local function getRandomImageId()
    return BackgroundImages[math.random(1, #BackgroundImages)]
end

-- H√†m √°p d·ª•ng h√¨nh n·ªÅn
local function applyHubBackground(imageId, transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                local largestFrame = nil
                local maxSize = 0

                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame.BackgroundTransparency < 1 then
                        local frameSize = frame.AbsoluteSize.X * frame.AbsoluteSize.Y
                        if frameSize > maxSize then
                            maxSize = frameSize
                            largestFrame = frame
                        end
                    end
                end

                if largestFrame then
                    if largestFrame:FindFirstChild("HubBackground") then
                        largestFrame:FindFirstChild("HubBackground"):Destroy()
                    end

                    local background = Instance.new("ImageLabel")
                    background.Name = "HubBackground"
                    background.Parent = largestFrame
                    background.Size = UDim2.new(1, 0, 1, 0)
                    background.Position = UDim2.new(0, 0, 0, 0)
                    background.Image = "rbxassetid://" .. imageId
                    background.BackgroundTransparency = 1
                    background.ImageTransparency = transparency or 0.7
                    background.ScaleType = Enum.ScaleType.Stretch
                    background.ZIndex = 0
                end
            end
        end
    end
end

-- H√†m x√≥a h√¨nh n·ªÅn
local function resetBackground()
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame:FindFirstChild("HubBackground") then
                        frame:FindFirstChild("HubBackground"):Destroy()
                    end
                end
            end
        end
    end
end

-- H√†m √°p d·ª•ng ƒë·ªô trong su·ªët c·ªßa h√¨nh n·ªÅn
local function applyBackgroundTransparency(transparency)
    if gethui():FindFirstChild("Orion") then
        for _, gui in pairs(gethui():GetChildren()) do
            if gui.Name == "Orion" then
                for _, frame in pairs(gui:GetDescendants()) do
                    if frame:IsA("Frame") and frame:FindFirstChild("HubBackground") then
                        frame.HubBackground.ImageTransparency = transparency
                    end
                end
            end
        end
    end
end

-- T·∫£i m√†u ƒë√£ l∆∞u
savedHubColor = loadColor(hubColorFile, Color3.fromRGB(30, 30, 30))
savedTextAndBorderColor = loadColor(textAndBorderColorFile, Color3.fromRGB(255, 255, 255))

-- ========== T·∫†O WINDOW CH√çNH ==========
local Window = OrionLib:MakeWindow({
    Name = "Mixi Jood Piece",
    HidePremium = false,
    SaveConfig = false,
    IntroEnabled = false
})

-- ========== TAB MAIN (CH·ª®C NƒÇNG CH√çNH) ==========
local MainTab = Window:MakeTab({
    Name = "Click It",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

-- Auto Summon v·ªõi icon
MainTab:AddToggle({
    Name = "Auto Summon Sukuna",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSummon = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoSummon then
            pcall(function()
                ReplicatedStorage.System.Summon:FireServer("Sukuna")
            end)
            task.wait(getgenv().NoDelay and 0 or DelayTime)
        else
            task.wait(0.2)
        end
    end
end)

-- Auto Random v·ªõi icon
MainTab:AddToggle({
    Name = "Auto Random Item",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoRandom = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoRandom then
            pcall(function()
                ReplicatedStorage.System.RandomItem:FireServer(5)
            end)
            task.wait(getgenv().NoDelay and 0 or DelayTime)
        else
            task.wait(0.2)
        end
    end
end)

-- Auto Store v·ªõi icon
MainTab:AddToggle({
    Name = "Auto C·∫•t",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoStore = Value
    end
})

task.spawn(function()
    while true do
        if getgenv().AutoStore then
            for _,tool in pairs(Player.Backpack:GetChildren()) do
                if tool:IsA("Tool") then
                    pcall(function()
                        ReplicatedStorage.System.Inv.Inventory:InvokeServer("Add", tool.Name)
                    end)
                end
            end
            task.wait(getgenv().NoDelay and 0 or 2)
        else
            task.wait(0.5)
        end
    end
end)

-- Auto Skill Z v·ªõi icon
MainTab:AddToggle({
    Name = "Z",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillZ = Value
    end
})

-- Auto Skill X v·ªõi icon
MainTab:AddToggle({
    Name = "X",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillX = Value
    end
})

-- Auto Skill C v·ªõi icon
MainTab:AddToggle({
    Name = "C",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillC = Value
    end
})

-- Auto Skill V v·ªõi icon
MainTab:AddToggle({
    Name = "V",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        getgenv().AutoSkillV = Value
    end
})

-- Auto Skills Combined
task.spawn(function()
    while true do
        if getgenv().AutoSkillZ or getgenv().AutoSkillX or getgenv().AutoSkillC or getgenv().AutoSkillV then
            if getgenv().AutoSkillZ then
                pcall(function() useSkill("Z") end)
            end
            if getgenv().AutoSkillX then
                pcall(function() useSkill("X") end)
            end
            if getgenv().AutoSkillC then
                pcall(function() useSkill("C") end)
            end
            if getgenv().AutoSkillV then
                pcall(function() useSkill("V") end)
            end
            task.wait(getgenv().NoDelay and 0.1 or 0.5)
        else
            task.wait(0.2)
        end
    end
end)

-- N√∫t Test Skill
MainTab:AddButton({
    Name = "Test Skill Z (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("Z") end
})

MainTab:AddButton({
    Name = "Test Skill X (1 l·∫ßn)",  
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("X") end
})

MainTab:AddButton({
    Name = "Test Skill C (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("C") end
})

MainTab:AddButton({
    Name = "Test Skill V (1 l·∫ßn)",
    Icon = "rbxassetid://80452964168019",
    Callback = function() useSkill("V") end
})

-- No Delay
MainTab:AddToggle({
    Name = "No Delay",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value) getgenv().NoDelay = Value end
})

-- ========== TAB RAINBOW EFFECT (CH·ªà EFFECT M·ªöI) ==========
local RainbowTab = Window:MakeTab({
    Name = "ƒê·ªïi M√†u LGBT",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

-- Toggle b·∫≠t/t·∫Øt rainbow effect (CH·ªà EFFECT M·ªöI)
RainbowTab:AddToggle({
    Name = "All skill=LGBT",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(Value)
        toggleRainbowEffect(Value)
    end
})

-- Label th√¥ng b√°o
RainbowTab:AddLabel("üé® CH·ªà effect m·ªõi xu·∫•t hi·ªán m·ªõi ƒë·ªïi m√†u")
RainbowTab:AddLabel("‚ö° Effect c√≥ s·∫µn s·∫Ω GI·ªÆ NGUY√äN")
RainbowTab:AddLabel("üìå H·ªó tr·ª£: ParticleEmitter, Fire, Sparkles, Trail, Beam, Light...")

-- ========== TAB GIAO DI·ªÜN (HUB) ==========
local HubTab = Window:MakeTab({
    Name = "Hub Settings",
    Icon = "rbxassetid://80452964168019",
    PremiumOnly = false
})

local backgroundEnabled = false
local currentTransparency = 0.7
local hubTransparency = 0.3

-- Toggle b·∫≠t/t·∫Øt h√¨nh n·ªÅn
HubTab:AddToggle({
    Name = "B·∫≠t/T·∫Øt H√¨nh N·ªÅn (Random)",
    Default = false,
    Icon = "rbxassetid://80452964168019",
    Callback = function(isOn)
        backgroundEnabled = isOn
        if isOn then
            applyHubBackground(getRandomImageId(), currentTransparency)
        else
            resetBackground()
        end
    end
})

-- Dropdown ch·ªçn ·∫£nh
HubTab:AddDropdown({
    Name = "Ch·ªçn ·∫¢nh N·ªÅn C·ª• Th·ªÉ",
    Options = {
        "79464702411655 - ·∫¢nh 1",
        "78188111267182 - ·∫¢nh 2",
        "87324819549778 - ·∫¢nh 3",
        "106183662263394 - ·∫¢nh 4 (M·ªõi)",
        "101124835052371 - ·∫¢nh 5 (M·ªõi)",
        "104282201865978 - ·∫¢nh 6 (M·ªõi)",
        "109827889408368 - ·∫¢nh 7 (M·ªõi)"
    },
    Default = "79464702411655 - ·∫¢nh 1",
    Callback = function(value)
        local selectedId = value:match("(%d+)")
        if selectedId then
            applyHubBackground(selectedId, currentTransparency)
            backgroundEnabled = true
        end
    end
})

-- Slider ƒë·ªô trong su·ªët Hub
HubTab:AddSlider({
    Name = "ƒê·ªô Trong Su·ªët Hub",
    Min = 0.0,
    Max = 0.98,
    Default = hubTransparency,
    Increment = 0.1,
    Callback = function(value)
        hubTransparency = value
        applyHubTransparency(value)
    end
})

-- Slider ƒë·ªô r√µ h√¨nh n·ªÅn
HubTab:AddSlider({
    Name = "ƒê·ªô R√µ H√¨nh N·ªÅn",
    Min = 0.1,
    Max = 0.98,
    Default = currentTransparency,
    Increment = 0.1,
    Callback = function(value)
        currentTransparency = value
        if backgroundEnabled then
            applyBackgroundTransparency(value)
        end
    end
})

-- Color Picker ƒë·ªïi m√†u Hub
HubTab:AddColorpicker({
    Name = "ƒê·ªïi M√†u Hub",
    Default = savedHubColor,
    Callback = function(Value)
        savedHubColor = Value
        saveColor(Value, hubColorFile)
        applyHubColor(savedHubColor)
    end
})

-- Color Picker ƒë·ªïi m√†u ch·ªØ
HubTab:AddColorpicker({
    Name = "ƒê·ªïi M√†u Ch·ªØ",
    Default = savedTextAndBorderColor,
    Callback = function(Value)
        savedTextAndBorderColor = Value
        saveColor(Value, textAndBorderColorFile)
        applyTextAndBorderColor(savedTextAndBorderColor)
    end
})

-- N√∫t l√†m m·ªõi giao di·ªán
HubTab:AddButton({
    Name = "L√†m M·ªõi Giao Di·ªán",
    Icon = "rbxassetid://80452964168019",
    Callback = function()
        applyHubColor(savedHubColor)
        applyTextAndBorderColor(savedTextAndBorderColor)
        applyHubTransparency(hubTransparency)
        if backgroundEnabled then
            applyHubBackground(getRandomImageId(), currentTransparency)
        end
    end
})

-- N√∫t x√≥a h√¨nh n·ªÅn
HubTab:AddButton({
    Name = "üóëÔ∏è X√≥a H√¨nh N·ªÅn",
    Icon = "rbxassetid://80452964168019",
    Callback = function()
        resetBackground()
        backgroundEnabled = false
    end
})

-- ========== √ÅP D·ª§NG M√ÄU KHI KH·ªûI ƒê·ªòNG ==========
task.wait(1)
applyHubColor(savedHubColor)
applyTextAndBorderColor(savedTextAndBorderColor)
applyHubTransparency(hubTransparency)

-- ========== KH·ªûI T·∫†O ORIONLIB ==========
OrionLib:Init()
